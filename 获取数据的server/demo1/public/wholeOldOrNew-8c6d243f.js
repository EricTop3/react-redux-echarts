webpackJsonp([17],{240:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),c=a(1),u=l(c),d=a(8),m=l(d),o=a(11),f=(l(o),a(13)),p=a(10),h=(l(p),a(3)),E=l(h),N=a(21),v=l(N),O=a(537),T=l(O);a(18),a(28),a(19),a(27),a(20);var w=a(31),y=l(w),g=a(26),b=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.resizeFun=function(){a.state.resizeHandler&&clearTimeout(a.state.resizeHandler),a.state.compareOldOrNewChart&&(a.state.resizeHandler=setTimeout(function(){a.state.compareOldOrNewChart.resize()},100))},a.changeTime=function(e){if("active"!==e.target.className)switch(e.target.innerText){case"日":return void a.setState({time:"day",selectTime:"day"});case"周":return void a.setState({time:"week",selectTime:"week"});case"月":a.setState({time:"month",selectTime:"month"})}},a.search=function(){var e=m.default.findDOMNode(a.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value,t=m.default.findDOMNode(a.refs.selectTime2).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value;e=T.default.changeTime(e),t=T.default.changeTime(t),m.default.findDOMNode(a.refs.selectTime1).className=m.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError",""),m.default.findDOMNode(a.refs.selectTime2).className=m.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError","");var l=new Date(e).getTime(),n=new Date(t).getTime(),s=Date.now(),r=!1;if(l>s&&(m.default.findDOMNode(a.refs.selectTime1).className+=" selectTimeError",r=!0),l>n&&(m.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",r=!0),n>s&&(m.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",r=!0),r)return!1;a.props.oldOrNewInit(e+","+t,a.state.selectTime),a.state.time1=e,a.state.time2=t},a.state={compareOldOrNewChart:"",resizeHandler:null,Data:[],selectTime:"day",time:"",time1:"",time2:"",new1List:"",old1List:"",percent1List:"",new2List:"",old2List:"",percent2List:""},a}return r(t,e),i(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e,t){if(this.props!==e){var a=e.oldOrNew.toJS(),l=a.xAxis[0].data,n=a.xAxis[0].num1New,s=a.xAxis[0].num1Old,r=a.xAxis[0].num2New,i=a.xAxis[0].num2Old,c=a.series[0].data,u=a.series[1].data;this.setState({timeList:l,new1List:n,old1List:s,new2List:r,old2List:i,percent1List:c,percent2List:u}),a.series[0].data&&a.series[0].data&&a.series[0].data[0]&&(a.legend.data.push("时间一","时间二"),a.series[0].name="时间一",a.series[1].name="时间二",this.state.compareOldOrNewChart.setOption(a),this.state.compareOldOrNewChart.hideLoading())}}},{key:"componentDidMount",value:function(){var e=T.default.getTime();this.state.time=e,this.state.time1=e.split(",")[0],this.state.time2=e.split(",")[1],this.props.oldOrNewInit(T.default.changeTime(this.state.time),this.state.selectTime),m.default.findDOMNode(this.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value=this.state.time.split(",")[0];var t=m.default.findDOMNode(this.refs.compareOldOrNewChart);this.state.compareOldOrNewChart=E.default.init(t),this.state.compareOldOrNewChart.showLoading(),window.addEventListener("resize",this.resizeFun)}},{key:"componentWillUnmount",value:function(){this.state.compareOldOrNewChart.dispose(),window.removeEventListener("resize",this.resizeFun)}},{key:"render",value:function(){var e=this.state,t=e.timeList,a=e.new1List,l=e.old1List,n=e.percent1List,s=e.new2List,r=e.old2List,i=e.percent2List,c=[],d=void 0,m=void 0;return t&&t.forEach(function(e,o){d=t[o].split("/")[0],m=t[o].split("/")[1],c.push(u.default.createElement("tr",{key:o},u.default.createElement("td",null,d),u.default.createElement("td",null,a[o]),u.default.createElement("td",null,l[o]),u.default.createElement("td",null,n[o],"%"),u.default.createElement("td",null,m),u.default.createElement("td",null,s[o]),u.default.createElement("td",null,r[o]),u.default.createElement("td",null,i[o],"%")))}),u.default.createElement("div",{className:"chartWrapper"},u.default.createElement("div",{className:"selectOption inline"},"时间：",u.default.createElement("div",{className:"selectTime1",ref:"selectTime1"},u.default.createElement(v.default,null)),"   对比时间： ",u.default.createElement("div",{className:"selectTime1",ref:"selectTime2"},u.default.createElement(v.default,null)),"      对比时间范围：",u.default.createElement("div",{className:"quickSelect defaultCursor"},u.default.createElement("ul",null,u.default.createElement("li",null,u.default.createElement("a",{className:"day"==this.state.selectTime?"active":"",onClick:this.changeTime},"日")),u.default.createElement("li",null,u.default.createElement("a",{className:"week"==this.state.selectTime?"active":"",onClick:this.changeTime},"周")),u.default.createElement("li",null,u.default.createElement("a",{className:"month"==this.state.selectTime?"active":"",onClick:this.changeTime},"月")))),u.default.createElement("div",{className:"selectClick"},u.default.createElement("input",{type:"button",value:"查询",onClick:this.search}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"新老顾客对比 ",u.default.createElement(g,{className:"questionMark"}),u.default.createElement("div",{className:"messageMark"},u.default.createElement("p",null,"展示商城在两个时间段内新老顾客对比",u.default.createElement("br",null)))),u.default.createElement("div",{className:"panelBody"},u.default.createElement("div",{ref:"compareOldOrNewChart",className:"compareOldOrNewChart"}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"新老顾客对比明细"),u.default.createElement("div",{className:"panelBody"},u.default.createElement("table",{className:"Table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,"时间一"),u.default.createElement("th",null,"新顾客量"),u.default.createElement("th",null,"老顾客量"),u.default.createElement("th",null,"新顾客率"),u.default.createElement("th",null,"时间二"),u.default.createElement("th",null,"新顾客量"),u.default.createElement("th",null,"老顾客量"),u.default.createElement("th",null,"新顾客率"))),u.default.createElement("tbody",null,c)))))}}]),t}(u.default.Component);b.propTypes={};var L=function(e){return{oldOrNew:e.getIn(["d","oldOrNew"])}};t.default=(0,f.connect)(L,y.default)(b)},537:function(e,t,a){"use strict";function l(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,l=e.getDate();return t+"-"+a+"-"+(l-1)+","+t+"-"+a+"-"+l}function n(e){if(e){if(e.indexOf(",")>-1){var t=e.split(",");return n(t[0])+","+n(t[1])}var a=e.split("-");return a[1]=a[1]>=10?a[1]:"0"+a[1],a[2]=a[2]>=10?a[2]:"0"+a[2],a.join("-")}}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getTime:l,changeTime:n}}});