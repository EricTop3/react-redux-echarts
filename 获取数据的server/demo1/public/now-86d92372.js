webpackJsonp([32],{245:function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,n,l){return n&&e(t.prototype,n),l&&e(t,l),t}}(),u=n(1),o=l(u),c=n(8),f=l(c),m=n(11),d=(l(m),n(13)),h=n(10),p=l(h),g=n(3),y=l(g);n(18),n(70),n(19),n(27),n(20),n(128);var S=n(536),v=l(S),C=n(26),N=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.resizeFun=function(){n.state.resizeHandler&&clearTimeout(n.state.resizeHandler),n.state.singleSellerCustomerNumChart&&(n.state.resizeHandler=setTimeout(function(){n.state.singleSellerCustomerNumChart.resize(),n.state.singleSellerCustomerNumChart.resize()},100))},n.fetchData=function(){n.props.singleSellerCustomerNumFetch(n.props.params.id)},n.state={singleSellerCustomerNumChart:"",now:{},yesterday:{},param:"",name:"",timer:"",timeList:"",numList:"",percentList:"",tableSpace:3,timerTime:1e4,resizeHandler:null},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){scrollTo(0,0);var e=this.props.params.id;this.props.singleSellerCustomerNumInit(e),this.props.changeSellerName(e)}},{key:"componentDidMount",value:function(){var e=f.default.findDOMNode(this.refs.singleSellerCustomerNumChart);this.state.singleSellerCustomerNumChart=y.default.init(e),this.state.singleSellerCustomerNumChart.showLoading(),this.state.timer=setInterval(this.fetchData,this.state.timerTime),window.addEventListener("resize",this.resizeFun)}},{key:"componentWillReceiveProps",value:function(e,t){this.state.param&&this.state.param!==e.params.id&&(clearInterval(this.state.timer),this.props.singleSellerCustomerNumInit(e.params.id),this.setState({timer:setInterval(this.fetchData,this.state.timerTime)}),this.props.changeSellerName(e.params.id));var n=e.customerNum.toJS();if(n.series[0]&&n.series[0].data&&n.series[0].data[0]){var l={numLen:"",num:"",doorNumLen:"",doorNum:"",percentLen:"",percent:""},r=n.xAxis[0].yesterday,a=n.xAxis[0].data.reverse(),i=n.series[0].data.reverse(),s=n.series[1].data.reverse(),u=n.series[2].data.reverse();l.numLen=i.length,l.num=i[l.numLen-1],l.doorNumLen=s.length,l.doorNum=s[l.doorNumLen-1],l.percentLen=u.length,l.percent=u[l.percentLen-1],this.setState({now:l,yesterday:r,timeList:a,numList:i,doorNumList:s,percentList:u}),this.setState({param:e.params.id}),this.state.singleSellerCustomerNumChart.setOption(n),this.state.singleSellerCustomerNumChart.hideLoading()}}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.timer),this.state.singleSellerCustomerNumChart.dispose(),window.removeEventListener("resize",this.resizeFun)}},{key:"render",value:function(){var e=this.state,t=e.now,n=e.yesterday,l=e.timeList,r=e.numList,a=e.doorNumList,i=e.percentList,s=e.tableSpace,u=[];return l&&l.forEach(function(e,t){t%s||u.push(o.default.createElement("tr",{key:t},o.default.createElement("td",null,l[t]),o.default.createElement("td",null,a[t]),o.default.createElement("td",null,r[t]),o.default.createElement("td",null,i[t],"%")))}),o.default.createElement("div",{className:"panelWrapper"},o.default.createElement("div",{className:"topMessage"},o.default.createElement("div",{className:"message message1"},o.default.createElement("div",null,o.default.createElement("p",null,"当前客流：",t.num," "),o.default.createElement("p",null,"当前时间：",l?l[l.length-1]:""))),o.default.createElement("div",{className:"message message2"},o.default.createElement("div",null,o.default.createElement("p",null,"当前门前客流：",a?a[a.length-1]:""),o.default.createElement("p",null,"客流占比：",i?i[i.length-1]:"","%"))),o.default.createElement("div",{className:"message message3"},o.default.createElement("div",null,o.default.createElement("p",null,"昨日高峰客流：",n.num),o.default.createElement("p",null,"昨日高峰出现时间：",n.time)))),o.default.createElement("div",{className:"panel"},o.default.createElement("div",{className:"panelHead"},"实时客流量 ",o.default.createElement(C,{className:"questionMark"}),o.default.createElement("div",{className:"messageMark"},o.default.createElement("p",null,"展示商家实时客流量、门前客流量及客流总体占比",o.default.createElement("br",null),o.default.createElement("strong",null,"客流量"),"：当前在店铺内的人数",o.default.createElement("br",null),o.default.createElement("strong",null,"门前客流量"),"：经过店铺门口的人数",o.default.createElement("strong",null,"客流总体占比"),"：店铺内的人数占整个商城的人数比例"))),o.default.createElement("div",{className:"panelBody"},o.default.createElement("div",{className:"singleSellerCustomerNumChart",ref:"singleSellerCustomerNumChart"}))),o.default.createElement("div",{className:"panel"},o.default.createElement("div",{className:"panelHead"},"当前实时客流数据"),o.default.createElement("div",{className:"panelBody"},o.default.createElement("table",{className:"Table"},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",null,"时间"),o.default.createElement("th",null,"门前客流量"),o.default.createElement("th",null,"店铺客流量"),o.default.createElement("th",null,"客流总体占比"))),o.default.createElement("tbody",null,u)))))}}]),t}(o.default.Component);N.propTypes={params:o.default.PropTypes.object.isRequired,singleSellerCustomerNumInit:o.default.PropTypes.func.isRequired,singleSellerCustomerNumFetch:o.default.PropTypes.func.isRequired,customerNum:o.default.PropTypes.instanceOf(p.default.Map)};var E=function(e){return{customerNum:e.getIn(["b","customerNum"])}};t.default=(0,d.connect)(E,v.default)(N)},536:function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(127),a=l(r),i=n(45),s=l(i),u=s.default.sellers,o=a.default.sellers,c={sellersListInit:function(){return function(e){fetch(o.sellersListInit+"/").then(function(e){return e.json()}).then(function(t){e({type:u.sellersListInit,payload:t})}).catch(function(e){console.log(e)})}},allSellersLineChartInit:function(e,t){return function(n){var l=o.allSellersLineChartInit+e+"/"+t+"/";fetch(l).then(function(e){return e.json()}).then(function(e){n({type:u.allSellersLineChartInit,payload:e})}).catch(function(e){console.log(e)})}},singleSellerLineChartInit:function(e,t){return function(n){var l=o.singleSellerLineChartInit+e+"/"+t+"/";fetch(l).then(function(e){return e.json()}).then(function(e){n({type:u.singleSellerLineChartInit,payload:e})}).catch(function(e){console.log(e)})}},singleSellerCustomerNumInit:function(e){return function(t){var n=o.singleSellerCustomerNumInit+e+"/";fetch(n).then(function(e){return e.json()}).then(function(e){t({type:u.singleSellerCustomerNumInit,payload:e})}).catch(function(e){console.log(e)})}},singleSellerCustomerNumFetch:function(e){var t=o.singleSellerCustomerNumFetch+e+"/";return function(e){fetch(t).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerCustomerNumFetch,payload:t})}).catch(function(e){console.log(e)})}},singleSellerCustomerAvgInit:function(e,t){var n=o.singleSellerCustomerAvgInit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerCustomerAvgInit,payload:t})}).catch(function(e){console.log(e)})}},singleSellerCustomerFlowInit:function(e,t){var n=o.singleSellerCustomerFlowInit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerCustomerFlowInit,payload:t})}).catch(function(e){console.log(e)})}},singleSellerCustomerInInit:function(e,t){var n=o.singleSellerCustomerInInit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerCustomerInInit,payload:t})}).catch(function(e){console.log(e)})}},singleSellerRadar:function(e){var t=o.singleSellerRadar+e+"/";return function(e){fetch(t).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerRadar,payload:t})}).catch(function(e){console.log(e)})}},singleSellerStayBar:function(e,t){var n=o.singleSellerStayBar+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerStayBar,payload:t})}).catch(function(e){console.log(e)})}},singleSellerOldOrNew:function(e,t){var n=o.singleSellerOldOrNew+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerOldOrNew,payload:t})}).catch(function(e){console.log(e)})}},singleSellerTimeSection:function(e,t){var n=o.singleSellerTimeSection+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerTimeSection,payload:t})}).catch(function(e){console.log(e)})}},singleSellerDeepVisit:function(e,t){var n=o.singleSellerDeepVisit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerDeepVisit,payload:t})}).catch(function(e){console.log(e)})}},singleSellerCycleInit:function(e,t){var n=o.singleSellerCycleInit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerCycleInit,payload:t})}).catch(function(e){console.log(e)})}},singleSellerActiveInit:function(e,t){var n=o.singleSellerActiveInit+e+"/"+t+"/";return function(e){fetch(n).then(function(e){return e.json()}).then(function(t){e({type:u.singleSellerActiveInit,payload:t})}).catch(function(e){console.log(e)})}}};t.default=c}});