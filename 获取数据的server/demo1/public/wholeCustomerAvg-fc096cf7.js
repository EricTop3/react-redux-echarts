webpackJsonp([22],{235:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),c=a(1),u=l(c),m=a(8),d=l(m),o=a(11),f=(l(o),a(13)),p=a(10),h=(l(p),a(3)),v=l(h),E=a(21),g=l(E),T=a(537),N=l(T);a(18),a(28),a(19),a(27),a(20);var y=a(31),C=l(y),b=a(26),w=function(e){function t(e){s(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.resizeFun=function(){a.state.resizeHandler&&clearTimeout(a.state.resizeHandler),a.state.compareCustomerAvgChart&&(a.state.resizeHandler=setTimeout(function(){a.state.compareCustomerAvgChart.resize()},100))},a.changeTime=function(e){if("active"!==e.target.className)switch(e.target.innerText){case"日":return void a.setState({time:"day",selectTime:"day"});case"周":return void a.setState({time:"week",selectTime:"week"});case"月":a.setState({time:"month",selectTime:"month"})}},a.search=function(){var e=d.default.findDOMNode(a.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value,t=d.default.findDOMNode(a.refs.selectTime2).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value;e=N.default.changeTime(e),t=N.default.changeTime(t),d.default.findDOMNode(a.refs.selectTime1).className=d.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError",""),d.default.findDOMNode(a.refs.selectTime2).className=d.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError","");var l=new Date(e).getTime(),s=new Date(t).getTime(),n=Date.now(),r=!1;if(l>n&&(d.default.findDOMNode(a.refs.selectTime1).className+=" selectTimeError",r=!0),l>=s&&(d.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",r=!0),s>n&&(d.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",r=!0),r)return!1;a.props.numAvgInit(e+","+t,a.state.selectTime),a.state.time1=e,a.state.time2=t},a.state={compareCustomerAvgChart:"",resizeHandler:null,Data:[],selectTime:"day",time:"",time1:"",time2:"",timeList:"",num1List:"",num2List:""},a}return r(t,e),i(t,[{key:"componentDidMount",value:function(){var e=N.default.getTime();this.state.time=e,this.state.time1=e.split(",")[0],this.state.time2=e.split(",")[1],this.props.numAvgInit(N.default.changeTime(this.state.time),this.state.selectTime),d.default.findDOMNode(this.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value=this.state.time.split(",")[0];var t=d.default.findDOMNode(this.refs.compareCustomerAvgChart);this.state.compareCustomerAvgChart=v.default.init(t),this.state.compareCustomerAvgChart.showLoading(),window.addEventListener("resize",this.resizeFun)}},{key:"componentWillUnmount",value:function(){this.state.compareCustomerAvgChart.dispose(),window.removeEventListener("resize",this.resizeFun)}},{key:"componentWillReceiveProps",value:function(e,t){if(this.props!==e){var a=e.customerAvg.toJS(),l=a.xAxis[0].data,s=a.series[0].data,n=a.series[1].data;this.setState({timeList:l,num1List:s,num2List:n}),a.series[0].data&&a.series[0].data&&a.series[0].data[0]&&(a.legend.data.push("时间一","时间二"),a.series[0].name="时间一",a.series[1].name="时间二",this.state.compareCustomerAvgChart.setOption(a),this.state.compareCustomerAvgChart.hideLoading())}}},{key:"render",value:function(){var e=this.state,t=e.timeList,a=e.num1List,l=e.num2List,s=[],n=void 0,r=void 0;if(t&&t.forEach(function(e,i){n=t[i].split("/")[0],r=t[i].split("/")[1],s.push(u.default.createElement("tr",{key:i},u.default.createElement("td",null,n),u.default.createElement("td",null,a[i]),u.default.createElement("td",null,r),u.default.createElement("td",null,l[i])))}),this.state.Data.series&&this.state.Data.series[0].data){var i=this.state.Data.xAxis[0].data,c=this.state.Data.series[0].data,m=this.state.Data.series[1].data;i.forEach(function(e,t){s.push(u.default.createElement("tr",{key:t},u.default.createElement("th",null,t+1),u.default.createElement("td",null,e),u.default.createElement("td",null,c[t],m[t]>0?u.default.createElement("span",{className:"up"}," ↑"):u.default.createElement("span",{className:"down"}," ↓")),u.default.createElement("td",{className:m[t]>0?"up":"down"},m[t],"%")))})}return u.default.createElement("div",{className:"chartWrapper"},u.default.createElement("div",{className:"selectOption inline"},"时间：",u.default.createElement("div",{className:"selectTime1",ref:"selectTime1"},u.default.createElement(g.default,null)),"   对比时间： ",u.default.createElement("div",{className:"selectTime1",ref:"selectTime2"},u.default.createElement(g.default,null)),"      对比时间范围：",u.default.createElement("div",{className:"quickSelect defaultCursor"},u.default.createElement("ul",null,u.default.createElement("li",null,u.default.createElement("a",{className:"day"==this.state.selectTime?"active":"",onClick:this.changeTime},"日")),u.default.createElement("li",null,u.default.createElement("a",{className:"week"==this.state.selectTime?"active":"",onClick:this.changeTime},"周")),u.default.createElement("li",null,u.default.createElement("a",{className:"month"==this.state.selectTime?"active":"",onClick:this.changeTime},"月")))),u.default.createElement("div",{className:"selectClick"},u.default.createElement("input",{type:"button",value:"查询",onClick:this.search}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"客流量对比 ",u.default.createElement(b,{className:"questionMark"}),u.default.createElement("div",{className:"messageMark"},u.default.createElement("p",null,"展示商城在两个时间段内的客流平均值对比",u.default.createElement("br",null)))),u.default.createElement("div",{className:"panelBody"},u.default.createElement("div",{ref:"compareCustomerAvgChart",className:"compareCustomerAvgChart"}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"客流量对比明细"),u.default.createElement("div",{className:"panelBody"},u.default.createElement("table",{className:"Table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,"时间一"),u.default.createElement("th",null,"客流量"),u.default.createElement("th",null,"时间二"),u.default.createElement("th",null,"客流量"))),u.default.createElement("tbody",null,s)))))}}]),t}(u.default.Component);w.propTypes={};var O=function(e){return{customerAvg:e.getIn(["d","customerAvg"])}};t.default=(0,f.connect)(O,C.default)(w)},537:function(e,t,a){"use strict";function l(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,l=e.getDate();return t+"-"+a+"-"+(l-1)+","+t+"-"+a+"-"+l}function s(e){if(e){if(e.indexOf(",")>-1){var t=e.split(",");return s(t[0])+","+s(t[1])}var a=e.split("-");return a[1]=a[1]>=10?a[1]:"0"+a[1],a[2]=a[2]>=10?a[2]:"0"+a[2],a.join("-")}}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getTime:l,changeTime:s}}});