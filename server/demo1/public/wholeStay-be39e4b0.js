webpackJsonp([14],{248:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),c=a(1),u=l(c),m=a(7),d=l(m),o=a(11),f=(l(o),a(13)),p=a(10),h=(l(p),a(3)),E=l(h),v=a(22),y=l(v),T=a(563),N=l(T);a(19),a(29),a(20),a(28),a(21);var g=a(32),b=l(g),O=a(27),w=function(e){function t(e){n(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.resizeFun=function(){a.state.resizeHandler&&clearTimeout(a.state.resizeHandler),a.state.compareStayChart&&(a.state.resizeHandler=setTimeout(function(){a.state.compareStayChart.resize()},100))},a.changeTime=function(e){if("active"!==e.target.className)switch(e.target.innerText){case"日":return void a.setState({time:"day",selectTime:"day"});case"周":return void a.setState({time:"week",selectTime:"week"});case"月":a.setState({time:"month",selectTime:"month"})}},a.search=function(){var e=d.default.findDOMNode(a.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value,t=d.default.findDOMNode(a.refs.selectTime2).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value;e=N.default.changeTime(e),t=N.default.changeTime(t),d.default.findDOMNode(a.refs.selectTime1).className=d.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError",""),d.default.findDOMNode(a.refs.selectTime2).className=d.default.findDOMNode(a.refs.selectTime1).className.replace(" selectTimeError","");var l=new Date(e).getTime(),n=new Date(t).getTime(),s=Date.now(),i=!1;if(l>s&&(d.default.findDOMNode(a.refs.selectTime1).className+=" selectTimeError",i=!0),l>=n&&(d.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",i=!0),n>s&&(d.default.findDOMNode(a.refs.selectTime2).className+=" selectTimeError",i=!0),i)return!1;a.props.stayInit(e+","+t,a.state.selectTime),a.state.time1=e,a.state.time2=t},a.state={compareStayChart:"",resizeHandler:null,Data:[],selectTime:"day",time:"",time1:"",time2:"",timeList:"",num1List:"",num2List:"",total1List:"",total2List:""},a}return i(t,e),r(t,[{key:"componentDidMount",value:function(){var e=N.default.getTime();this.state.time=e,this.state.time1=e.split(",")[0],this.state.time2=e.split(",")[1],this.props.stayInit(N.default.changeTime(this.state.time),this.state.selectTime),d.default.findDOMNode(this.refs.selectTime1).getElementsByClassName("calendar")[0].getElementsByTagName("input")[0].value=this.state.time.split(",")[0];var t=d.default.findDOMNode(this.refs.compareStayChart);this.state.compareStayChart=E.default.init(t),this.state.compareStayChart.showLoading(),window.addEventListener("resize",this.resizeFun)}},{key:"componentWillUnmount",value:function(){this.state.compareStayChart.dispose(),window.removeEventListener("resize",this.resizeFun)}},{key:"componentWillReceiveProps",value:function(e,t){if(this.props!==e){var a=e.stay.toJS();if(a.series[0].data&&a.series[0].data&&a.series[0].data[0]){var l=a.xAxis[0].data,n=a.series[0].data,s=a.series[1].data,i=n.reduce(function(e,t){return parseInt(e)+parseInt(t)}),r=s.reduce(function(e,t){return parseInt(e)+parseInt(t)});this.setState({timeList:l,num1List:n,num2List:s,total1List:i,total2List:r}),a.legend.data.push("时间一","时间二"),a.series[0].name="时间一",a.series[1].name="时间二",this.state.compareStayChart.setOption(a),this.state.compareStayChart.hideLoading()}}}},{key:"render",value:function(){var e=this.state,t=e.timeList,a=e.num1List,l=e.num2List,n=e.total1List,s=e.total2List,i=[],r=void 0,c=void 0;return t&&t.forEach(function(e,m){r=parseInt(parseInt(a[m])/n*100),c=parseInt(parseInt(l[m])/s*100),i.push(u.default.createElement("tr",{key:m},u.default.createElement("td",null,t[m]),u.default.createElement("td",null,a[m]),u.default.createElement("td",null,r,"%"),u.default.createElement("td",null,l[m]),u.default.createElement("td",null,c,"%")))}),u.default.createElement("div",{className:"chartWrapper"},u.default.createElement("div",{className:"selectOption inline"},"时间：",u.default.createElement("div",{className:"selectTime1",ref:"selectTime1"},u.default.createElement(y.default,null)),"   对比时间： ",u.default.createElement("div",{className:"selectTime1",ref:"selectTime2"},u.default.createElement(y.default,null)),"      对比时间范围：",u.default.createElement("div",{className:"quickSelect defaultCursor"},u.default.createElement("ul",null,u.default.createElement("li",null,u.default.createElement("a",{className:"day"==this.state.selectTime?"active":"",onClick:this.changeTime},"日")),u.default.createElement("li",null,u.default.createElement("a",{className:"week"==this.state.selectTime?"active":"",onClick:this.changeTime},"周")),u.default.createElement("li",null,u.default.createElement("a",{className:"month"==this.state.selectTime?"active":"",onClick:this.changeTime},"月")))),u.default.createElement("div",{className:"selectClick"},u.default.createElement("input",{type:"button",value:"查询",onClick:this.search}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"停留时长对比 ",u.default.createElement(O,{className:"questionMark"}),u.default.createElement("div",{className:"messageMark"},u.default.createElement("p",null,"展示商城在两个时间段内的停留时长对比",u.default.createElement("br",null)))),u.default.createElement("div",{className:"panelBody"},u.default.createElement("div",{ref:"compareStayChart",className:"compareStayChart"}))),u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:"panelHead"},"停留时长对比明细"),u.default.createElement("div",{className:"panelBody"},u.default.createElement("table",{className:"Table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,"停留时长"),u.default.createElement("th",null,"时间一人数"),u.default.createElement("th",null,"所占比例"),u.default.createElement("th",null,"时间二人数"),u.default.createElement("th",null,"所占比例"))),u.default.createElement("tbody",null,i)))))}}]),t}(u.default.Component);w.propTypes={};var C=function(e){return{stay:e.getIn(["d","stay"])}};t.default=(0,f.connect)(C,b.default)(w)},563:function(e,t,a){"use strict";function l(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,l=e.getDate();return t+"-"+a+"-"+(l-1)+","+t+"-"+a+"-"+l}function n(e){if(e){if(e.indexOf(",")>-1){var t=e.split(",");return n(t[0])+","+n(t[1])}var a=e.split("-");return a[1]=a[1]>=10?a[1]:"0"+a[1],a[2]=a[2]>=10?a[2]:"0"+a[2],a.join("-")}}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getTime:l,changeTime:n}}});